<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Panel - Servers</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/minecraft-3" rel="stylesheet">
    <link th:href="@{/css/servers.css}" rel="stylesheet">
</head>
<body>
    <div id="notification-container" class="notification-container"></div>

<div th:replace="~{fragments/common :: main-navbar(breadcrumbs=${breadcrumbs})}"></div>

<div class="main-container">
    <div class="page-header">
        <h1 class="page-title">My Servers</h1>
    </div>

    <div class="server-grid">
        <div class="server-card" th:each="server : ${servers}">
            <div class="server-card-content">
                <div class="card-header">
                    <div class="server-type-icon">
                        <img th:src="@{'/images/' + ${server.serverType?.toLowerCase()} + '.jpg'}"
                             th:alt="${server.serverType}" 
                             th:onerror="'this.src=\'/images/vanilla.jpg\''"
                             class="server-type-image">
                    </div>
                    <div class="header-content">
                        <a th:href="@{/servers/{id}/server(id=${server.id})}" class="server-name" th:text="${server.name}"></a>
                        <div class="server-tags">
                            <span class="version-tag" th:text="${server.version}" th:if="${server.version}"></span>
                            <span class="server-type-tag" th:text="${server.serverType}" th:if="${server.serverType}"></span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="delete-btn" th:data-id="${server.id}" th:data-name="${server.name}" title="Delete server">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3,6 5,6 21,6"></polyline>
                                <path d="m19,6v14a2,2 0,0 1,-2,2H7a2,2 0,0 1,-2,-2V6m3,0V4a2,2 0,0 1,2,-2h4a2,2 0,0 1,2,2v2"></path>
                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                <line x1="14" y1="11" x2="14" y2="17"></line>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="server-details">
                        <div class="detail-item">
                            <span class="detail-label">Server Port:</span>
                            <span class="detail-value" th:text="${server.port}"></span>
                        </div>
                        <div class="detail-item" th:if="${server.rconEnabled}">
                            <span class="detail-label">RCON Port:</span>
                            <span class="detail-value" th:text="${server.rconPort}"></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Instance Path:</span>
                            <span class="detail-value server-path" th:text="${server.instancePath}" th:title="${server.instancePath}"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="server-card add-server-card">
            <a href="/servers/create">
                <div class="card-header">+</div>
                <div class="card-body">
                    <p>Add New Server</p>
                </div>
            </a>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Delete Server</h3>
            <button id="close-delete-modal" class="close-btn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="delete-warning">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
                <p>Are you sure you want to delete the server <strong id="delete-server-name"></strong>?</p>
                <p class="warning-text">This action cannot be undone. All server files and data will be permanently deleted.</p>
            </div>
            <div class="modal-actions">
                <button id="cancel-delete" class="action-btn btn-secondary">Cancel</button>
                <button id="confirm-delete" class="action-btn btn-danger">Delete Server</button>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/js/servers.js}"></script>
</body>
</html>