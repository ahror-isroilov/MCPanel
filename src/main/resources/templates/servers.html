<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Minecraft Panel - Servers</title>
    <th:block th:insert="~{fragments/common :: common-head}"></th:block>
    <link rel="stylesheet" th:href="@{/css/servers.css}">
</head>
<body>

<div class="page-transition-wrapper">
    <div class="notification-container" id="notification-container"></div>

    <div th:replace="~{fragments/common :: main-navbar(breadcrumbs=${breadcrumbs})}"></div>

    <div class="main-container">
        <div class="page-header">
            <div>
                <h1 class="page-title" th:text="'Welcome back, ' + ${username} + '!'"></h1>
                <p class="page-subtitle">You have <span th:text="${#lists.size(servers)}"></span> total servers. <span
                        id="online-server-count">0</span> are currently online.</p>
            </div>
            <div class="search-sort-container">
                <input id="search-bar" placeholder="Search by name..." type="text">
            </div>
        </div>

        <!-- Server Grid - Display if servers exist -->
        <div class="server-grid" th:if="${!#lists.isEmpty(servers)}">
            <div class="server-card" th:each="server : ${servers}" th:data-server-id="${server.id}">
                <div class="server-card-content">
                    <div class="card-header">
                        <div class="header-top">
                            <div class="status-indicator offline"></div>
                            <div class="header-content">
                                <a class="server-name" th:href="@{/servers/{id}/server(id=${server.id})}" th:text="${server.name}"></a>
                            </div>
                            <div class="card-actions">
                                <button class="start-btn">Start</button>
                                <button class="stop-btn" style="display: none;">Stop</button>
                                <button class="delete-btn" title="Delete server">
                                    <svg fill="none" height="16" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="16">
                                        <polyline points="3,6 5,6 21,6"></polyline>
                                        <path d="m19,6v14a2,2 0,0 1,-2,2H7a2,2 0,0 1,-2,-2V6m3,0V4a2,2 0,0 1,2,-2h4a2,2 0,0 1,2,2v2"></path>
                                        <line x1="10" x2="10" y1="11" y2="17"></line>
                                        <line x1="14" x2="14" y1="11" y2="17"></line>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="server-tags">
                            <span class="version-tag" th:if="${server.version}" th:text="${server.version}"></span>
                            <span class="server-type-tag" th:if="${server.serverType}" th:text="${server.serverType}"></span>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="server-details">
                            <div class="detail-item">
                                <span class="detail-label">Status:</span>
                                <span class="detail-value status-text">Offline</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Server Port:</span>
                                <span class="detail-value" th:text="${server.port}"></span>
                            </div>
                            <div class="detail-item" th:if="${server.rconEnabled}">
                                <span class="detail-label">RCON Port:</span>
                                <span class="detail-value" th:text="${server.rconPort}"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="server-card add-server-card">
                <a href="/servers/create">
                    <div class="card-header">+</div>
                    <div class="card-body">
                        <p>Add New Server</p>
                    </div>
                </a>
            </div>
        </div>

        <!-- Empty State - Display if no servers exist -->
        <div class="empty-state" th:if="${#lists.isEmpty(servers)}">
            <div class="empty-state-icon">
                <i class="fas fa-server"></i>
            </div>
            <h2 class="empty-state-title">No Servers Yet!</h2>
            <p class="empty-state-description">It looks a bit empty here. Let's get your first Minecraft server up and running.</p>
            <a href="/servers/create" class="btn btn-primary">
                <i class="fas fa-plus"></i> Create Your First Server
            </a>
        </div>
    </div>
</div>

<div class="modal-overlay" id="delete-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Delete Server</h3>
            <button class="close-btn" id="close-delete-modal">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="delete-warning">
                <svg fill="none" height="48" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" width="48">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" x2="12" y1="8" y2="12"></line>
                    <line x1="12" x2="12.01" y1="16" y2="16"></line>
                </svg>
                <p>Are you sure you want to delete the server <strong id="delete-server-name"></strong>?</p>
                <p class="warning-text">This action cannot be undone. All server files and data will be permanently
                    deleted.</p>
            </div>
            <div class="modal-actions">
                <button class="action-btn btn-danger-subtle" id="confirm-delete">Yes, Delete Server</button>
                <button class="action-btn btn-secondary" id="cancel-delete">Cancel</button>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/js/servers.js}"></script>
<th:block th:insert="~{fragments/common :: common-scripts}"></th:block>

</body>
</html>
</html>